/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package medialib;

import java.util.List;

import javafx.application.Application;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.stage.Stage;

import io.github.palexdev.materialfx.theming.JavaFXThemes;
import io.github.palexdev.materialfx.theming.MaterialFXStylesheets;
import io.github.palexdev.materialfx.theming.UserAgentBuilder;

import utils.Parser;
import utils.Writer;

import utils.Models.Admin;
import utils.Models.User;
import utils.Models.Book;
import utils.Models.Category;


public class App extends Application {
  private static List<Admin> admins;
  private static List<User> users;
  private static List<Book> books;
  private static List<Category> categories;
  private static User currentUser;

  public static void initialize() {
    Parser parser = new Parser();

    parser.parse();

    admins = parser.getAdmins();
    users = parser.getUsers();
    books = parser.getBooks();
    categories = parser.getCategories();
  }

  public static void save() {
    Writer.write(users, books, categories);
  }

  public String getGreeting() {
    return "\n\n\nHello World!\n\n\n";
  }

  public static void printAdmins() {
    System.out.println("-----------------Admins-----------------");
    for (Admin admin : admins) {
      System.out.println(admin.getUsername());
    }
  }
  public static void printUsers() {
    System.out.println("-----------------Users------------------");
    for (User user : users) {
      System.out.println(user.getUsername());
    }
  }
  public static void printBooks() {
    System.out.println("-----------------Books------------------");
    for (Book book : books) {
      System.out.println(book.getTitle());
    }
  }
  public static void printCategories() {
    System.out.println("---------------Categories----------------");
    for (Category category : categories) {
      System.out.println(category.getTitle());
    }
  }
  public static void printAll() {
    printAdmins();
    printUsers();
    printBooks();
  }

  public static void randomize() {
    Writer.populate();
  }

  public static void main(String[] args) {
    if(false /* args[0].equals("--randomize" )*/) {
      randomize();
      System.exit(0);
    }

    initialize();
    // printAll();
    // printCategories();
    System.out.println("\n\nInitialization complete.\n\n\n");

    launch(args);

    save();
  }

  @Override
  public void start(Stage primaryStage) throws Exception {
    FXMLLoader loader = new FXMLLoader(getClass().getResource("/views/Home.fxml"));
    Parent root = loader.load();

    UserAgentBuilder.builder()
      .themes(JavaFXThemes.MODENA)
      .themes(MaterialFXStylesheets.forAssemble(true))
      .setDeploy(true)
      .setResolveAssets(true)
      .build()
      .setGlobal();

    primaryStage.setTitle("Medialab Library");
    primaryStage.setScene(new Scene(root));
    primaryStage.show();
  }

  public static Admin getAdminByUsername(String username) {
    for (Admin admin : admins) {
      if (admin.getUsername().equals(username)) {
        return admin;
      }
    }
    return null; // Admin not found
  }

  public static User getUserByUsername(String username) {
    for (User user : users) {
      if (user.getUsername().equals(username)) {
        return user;
      }
    }
    return null; // User not found
  }
  public static User getUserByEmail(String email) {
    for (User user : users) {
      if (user.getEmail().equals(email)) {
        return user;
      }
    }
    return null; // User not found
  }
  public static User getUserById(String id) {
    for (User user : users) {
      if (user.getId().equals(id)) {
        return user;
      }
    }
    return null; // User not found
  }

  public static void setCurrentUser(User user) {
    currentUser = user;
  }
  public static User getCurrentUser() {
    return currentUser;
  }

  public static void addUser(User user) {
    users.add(user);
  }

  public static List<Book> getBooks() {
    return books;
  }
  public static List<User> getUsers() {
    return users;
  }

  public static Book getBookByTitle(String title) {
    for (Book book : books) {
      if (book.getTitle().equals(title)) {
        return book;
      }
    }
    return null; // Book not found
  }

  public static List<Category> getCategories() {
    return categories;
  }

  public static void addBook(Book book) {
    books.add(book);
  }

  public static void removeBook(Book book) {
    books.remove(book);
  }

  public static Category getCategoryByTitle(String title) {
    for (Category category : categories) {
      if (category.getTitle().equals(title)) {
        return category;
      }
    }
    return null; // Category not found
  }

  public static void addCategory(Category category) {
    categories.add(category);
  }
  public static void removeCategory(Category category) {
    categories.remove(category);
  }

  public static void removeUser(User user) {
    users.remove(user);
  }

}
